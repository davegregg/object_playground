<!DOCTYPE html>
<html>
<head>
    <title></title>

    <script type="text/javascript" src="viz/viz.js"></script>

    <script type="text/javascript" src="object_node.js"></script>
    <script type="text/javascript" src="object_graph.js"></script>
    <script type="text/javascript" src="viz_visualizer.js"></script>
    <script type="text/javascript" src="user_code.js"></script>

</head>
<body>

<textarea id="usercode" cols="40" rows="10"></textarea>
<p></p>
<input type="button" id="evaluate" value="Evaluate"></input>
<p></p>
<div id="graph"></div>

<script>

  function inspect(s) {
    return "<pre>" + s.replace(/</g, "&lt;").replace(/>/g, "&gt;").replace(/\"/g, "&quot;") + "</pre>"
  }

  function render(src) {
      function MyClass() {}
  				MyClass.prototype.method = function aMethod() {};
  				var instance = new MyClass();


      return jdls.viz.render("this", jdls.usercode.evaluate(src));
  }

  function draw(src, element) {
    var markup;
    try {
      markup = render(src);
    } catch(e) {
      markup = inspect(e.toString());
    }
    element.innerHTML = markup;
      console.log(markup);
  }

  window.addEventListener("load", function() {
      var usercode = document.getElementById("usercode");
      var evalButton = document.getElementById("evaluate");
      var graph = document.getElementById("graph");
      usercode.value = jdls.usercode.samples.classical.code;
      draw(usercode.value, graph);

      evalButton.addEventListener("click", function(event) {
          draw(usercode.value, graph);
          event.preventDefault();
      });
  });

</script>

</body>
</html>